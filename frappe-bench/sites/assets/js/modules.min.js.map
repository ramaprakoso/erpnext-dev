{"version":3,"file":"modules.min.js","sources":["../../../apps/frappe/frappe/public/js/frappe/views/components/ModuleLinkItem.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/views/components/ModuleDetail.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/views/components/Modules.vue?rollup-plugin-vue=script.js","../../../apps/frappe/frappe/public/js/frappe/views/components/utils.js","../../../apps/frappe/frappe/public/js/frappe/views/modules_home.js"],"sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tprops: ['label', 'name', 'dependencies', 'incomplete_dependencies', 'onboard', 'count', 'route', 'doctype', 'open_count'],\n\tdata() {\n\t\treturn {\n\t\t\thover: false,\n\t\t\tpopover_hover: false,\n\t\t}\n\t},\n\tcomputed: {\n\t\tdisabled_dependent() {\n\t\t\treturn this.dependencies && this.incomplete_dependencies;\n\t\t},\n\n\t\tindicator_color() {\n\t\t\tif(this.open_count) {\n\t\t\t\treturn 'red';\n\t\t\t}\n\t\t\tif(this.onboard) {\n\t\t\t\treturn this.count ? 'blue' : 'orange';\n\t\t\t};\n\t\t\treturn 'grey';\n\t\t},\n\n\t\tpopover_active() {\n\t\t\treturn this.popover_hover || this.hover;\n\t\t}\n\t},\n\tmethods: {\n\t\tmouseover() {\n\t\t\t$('.module-link-popover').hide();\n\t\t\tthis.hover = true;\n\t\t},\n\n\t\tmouseleave() {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.hover = false;\n\t\t\t}, 300);\n\t\t}\n\t}\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport ModuleLinkItem from \"./ModuleLinkItem.vue\";\n\nexport default {\n\tcomponents: {\n\t\tModuleLinkItem\n\t},\n\tprops: ['module_name', 'sections'],\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport ModuleDetail from './ModuleDetail.vue'\nimport { generate_route } from './utils.js'\n\nexport default {\n  components: {\n    ModuleDetail,\n  },\n  data() {\n    return {\n      route: frappe.get_route(),\n      current_module_label: '',\n      current_module_sections: [],\n      modules_data_cache: {},\n      modules_list: frappe.boot.allowed_modules.filter(\n        d => (d.type === 'module' || d.category === 'Places') && !d.blocked\n      ),\n    }\n  },\n  created() {\n    this.update_current_module()\n  },\n  mounted() {\n    frappe.module_links = {}\n    frappe.route.on('change', () => {\n      this.update_current_module()\n    })\n  },\n  methods: {\n    update_current_module() {\n      let route = frappe.get_route()\n      if (route[0] === 'modules' || !route[0]) {\n        this.route = route\n        let module = this.modules_list.filter(m => m.module_name == route[1])[0]\n        let module_name = module && (module.label || module.module_name)\n        let title = this.current_module_label\n          ? this.current_module_label\n          : module_name\n\n        frappe.modules.home && frappe.modules.home.page.set_title(title)\n\n        if (!frappe.modules.home) {\n          setTimeout(() => {\n            frappe.modules.home.page.set_title(title)\n          }, 200)\n        }\n\n        if (module_name) {\n          this.get_module_sections(module.module_name)\n        }\n      }\n    },\n\n    get_module_sections(module_name) {\n      let cache = this.modules_data_cache[module_name]\n      if (cache) {\n        this.current_module_sections = cache\n      } else {\n        this.current_module_sections = []\n        return frappe.call({\n          method: 'frappe.desk.moduleview.get',\n          args: {\n            module: module_name,\n          },\n          callback: r => {\n            var m = frappe.get_module(module_name)\n            this.current_module_sections = r.message.data\n            this.process_data(module_name, this.current_module_sections)\n            this.modules_data_cache[module_name] = this.current_module_sections\n          },\n          freeze: true,\n        })\n      }\n    },\n    process_data(module_name, data) {\n      frappe.module_links[module_name] = []\n      data.forEach(function(section) {\n        section.items.forEach(function(item) {\n          item.route = generate_route(item)\n        })\n      })\n    },\n  },\n}\n","function generate_route(item) {\n\tif(item.type===\"doctype\") {\n\t\titem.doctype = item.name;\n\t}\n\tlet route = '';\n\tif(!item.route) {\n\t\tif(item.link) {\n\t\t\troute=strip(item.link, \"#\");\n\t\t} else if(item.type===\"doctype\") {\n\t\t\tif(frappe.model.is_single(item.doctype)) {\n\t\t\t\troute = 'Form/' + item.doctype;\n\t\t\t} else {\n\t\t\t\tif (item.filters) {\n\t\t\t\t\tfrappe.route_options=item.filters;\n\t\t\t\t}\n\t\t\t\troute=\"List/\" + item.doctype;\n\t\t\t}\n\t\t} else if(item.type===\"report\" && item.is_query_report) {\n\t\t\troute=\"query-report/\" + item.name;\n\t\t} else if(item.type===\"report\") {\n\t\t\troute=\"List/\" + item.doctype + \"/Report/\" + item.name;\n\t\t} else if(item.type===\"page\") {\n\t\t\troute=item.name;\n\t\t}\n\n\t\troute = '#' + route;\n\t} else {\n\t\troute = item.route;\n\t}\n\n\tif(item.route_options) {\n\t\troute += \"?\" + $.map(item.route_options, function(value, key) {\n\t\t\treturn encodeURIComponent(key) + \"=\" + encodeURIComponent(value); }).join('&');\n\t}\n\n\t// if(item.type===\"page\" || item.type===\"help\" || item.type===\"report\" ||\n\t// (item.doctype && frappe.model.can_read(item.doctype))) {\n\t//     item.shown = true;\n\t// }\n\treturn route;\n}\n\nexport {\n\tgenerate_route\n};\n","import Modules from './components/Modules.vue';\n\nfrappe.provide('frappe.modules');\n\nfrappe.modules.Home = class {\n\tconstructor({ parent }) {\n\t\tthis.$parent = $(parent);\n\t\tthis.page = parent.page;\n\t\tthis.setup_header();\n\t\tthis.make_body();\n\t}\n\tmake_body() {\n\t\tthis.$modules_container = this.$parent.find('.layout-main');\n\n\t\tnew Vue({\n\t\t\tel: this.$modules_container[0],\n\t\t\trender: h => h(Modules)\n\t\t});\n\t}\n\tsetup_header() {\n\t\t// subtitle\n\t}\n};\n"],"names":["props","data","hover","popover_hover","computed","disabled_dependent","this","dependencies","incomplete_dependencies","indicator_color","open_count","onboard","count","popover_active","methods","mouseover","$","hide","mouseleave","setTimeout","components","route","frappe","get_route","current_module_label","current_module_sections","modules_data_cache","modules_list","boot","allowed_modules","filter","d","type","category","blocked","created","update_current_module","mounted","module_links","on","let","module","m","module_name","label","title","modules","home","page","set_title","get_module_sections","cache","call","method","args","callback","r","get_module","message","process_data","freeze","forEach","section","items","item","doctype","name","link","strip","model","is_single","filters","route_options","is_query_report","map","value","key","encodeURIComponent","join","generate_route","provide","Home","[object Object]","ref","$parent","parent","setup_header","make_body","$modules_container","find","Vue","el","render","h","Modules"],"mappings":"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"}